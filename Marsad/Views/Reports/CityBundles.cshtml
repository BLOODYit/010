
@{
    ViewBag.Title = "CityBundles";
    Layout = "~/Views/Shared/_CityLayout.cshtml";
}

<div id='root'></div>
@section scripts{
    <script type="text/babel">        
        var url = '@Url.Action("CityIndicators", "Reports")';
        var bundles = [];
        @if (ViewBag.Bundles != null)
        {
            foreach (Marsad.Models.Bundle item in ViewBag.Bundles)
            {
                <text>bundles.push({ id:@item.ID, name:'@item.Name'})</text>
            }
        }


        const { useState } = React;
        const rootElement = document.getElementById("root");
        const Cell = (props) => {
        const { index } = props;
        const [active, handleActive] = useState(false);
        return (

        <div id="cardContainer"
             style={{
                            height: active ? `300px` : `100px`,
                transition: "0.9s"
            }}>
            <div id="first"
                 style={{
                    transform: active
                        ? `rotate3d(1, 0, 0, -180deg)`
                        : `rotate3d(1, 0, 0, 0deg)`,
                    transitionDelay: active ? "0s" : "0.3s"
                }}>
                <div id="firstTop" onClick={() =>
                    {
                    window.location.href = url + '?bundleId=' + bundles[index].id + '&geoAreaId='+@ViewBag.City.ID;
                    }}>
                    <div id="timecontainer">
                        {bundles[index].name}
                    </div>
                </div>
            </div>
        </div>
        );
        }


        const Header = (
        <div>
            <svg id="back"
                 xmlns="http://www.w3.org/2000/svg"
                 width="512"
                 height="512"
                 viewBox="0 0 512 512"
                 onClick={() =>
                {
                window.history.back();
                }} style={{ pointer:'cursor' }}>
                <polyline points="244 400 100 256 244 112"
                          style={{
                    fill: "none",
                    stroke: "#000",
                    strokeLinecap: "round",
                    strokeLinejoin: "round",
                    strokeWidth: "48px"
                }} />
                <line x1="120"
                      y1="256"
                      x2="412"
                      y2="256"
                      style={{
                    fill: "none",
                    stroke: "#000",
                    strokeLinecap: "round",
                    strokeLinejoin: "round",
                    strokeWidth: "48px"
                }} />
            </svg>
            <div id="headerText">المؤشرات الحضرية - @ViewBag.City.Name</div>            
        </div>
        );

        const App = () => {
        return (

        <div className="App">
            {Header}
            {bundles.map((val, i) => (
            <Cell key={i} index={i} />
            ))}
        </div>
        );
        }

        ReactDOM.render(
        <div><App /></div>, rootElement);
    </script>
}