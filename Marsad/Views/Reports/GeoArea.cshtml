@model IEnumerable<Marsad.Models.Case>
@using Marsad.Models.Controls
@{
    ViewBag.Title = "تقارير المقارنة لمؤشر في نطاق جغرافي";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="container">
    <div class="row">
        <div class="col-sm-12">
            <h2>تقارير المقارنة لمؤشر في نطاق جغرافي</h2>
        </div>
    </div>
    <div class="row">
        <form action="@Url.Action("GeoArea","Reports")" method="post">

            <div class="col-md-12">
                <select name="indicatorID" class="form-control" id="indicatorID" required>
                    <option value="">-- المؤشر --</option>
                    @foreach (var indicator in ViewBag.Indicators.Keys)
                    {
                        <option value="@indicator">@ViewBag.Indicators[indicator]</option>
                    }
                </select>
                <br>
            </div>
            <div class="col-md-6">
                <select class="form-control" name="geoArea1" id="geoArea1" required>
                </select>
            </div>
            <div class="col-md-6">
                <select class="form-control" name="geoArea2" id="geoArea2" required>
                </select>
            </div>
            <div class="col-md-12">
                <br />
                <button class="btn btn-primary" type="submit">عرض التقرير </button>
            </div>
        </form>
    </div>
    <div class="row">
        <div class="col-xs-12">
            @ViewBag.Result
        </div>
    </div>


</div>

@section scripts{
    <script type="text/javascript">
        $(document).ready(function () {
            $('#indicatorID').change(function () {
                $('#geoArea1 option').remove();
                $('#geoArea2 option').remove();
                var val = $(this).val();
                if (val != undefined && val > 0) {
                    var url = "@Url.Action("GetGeoAreas","Reports")/?indicatorID=" + val;
                    $.ajax({
                        url:url,
                        success:function(data) {
                            for (var i = 0; i < data.length; i++) {
                                $('#geoArea1').append("<option value='" + data[i].ID + "'>" + data[i].Name + "</option>");
                                $('#geoArea2').append("<option value='"+data[i].ID+"'>"+data[i].Name+"</option>");
                            }
                        }                      
                    });
                }
            });
        });
    </script>
}