@model UserGroup

@{
    ViewBag.Title = "Create";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@{
    List<string> Dumyclaims = new List<string>();

    Dumyclaims.Add("Can add");
    Dumyclaims.Add("Can Edit");
    Dumyclaims.Add("Can Delet");    

}

<div class="container">
<div class="row"> 
    <div class="form-horizontal"> 
	<h4>إنشاء مستخدمي مجموعة</h4>

        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        <div class="form-group">
            @Html.LabelFor(c=>c.Name, htmlAttributes: new { @class = "control-label col-sm-2 col-xs-12" })
            <div class="col-sm-10 col-xs-12">
                <input type="text" class="form-control" id="userGroupName" placeholder="ادخل اسم المجموعة" />
                @Html.ValidationMessageFor(u => u.Name, "", new { @class = "text-danger" })
                
                @foreach (var item in Dumyclaims)
                {
                <div class="checkbox"  >
                    <label>
                        <input class="alignleft" type="checkbox" id=`@Dumyclaims.IndexOf(item)`
                                name="Role"
                                value="@item"
                                />
                                   <span class="alignleft"> @item</span> 
                             
                        </label>
                    </div>
                    }
            </div>
        </div>
    
       @*onclick="addUserGroup()"*@
    


        <div class="form-group">
            <div class="col-sm-offset-2 col-sm-10 col-xs-12">
                <input id="btnSubmitUG" type="submit" value="إنشاء" class="btn btn-success"  disabled />				
				@*@Html.ActionLink("الرئيسية", "Index",null,new {@class="btn btn-default"})*@
            </div>
        </div>
    </div>


</div>
</div>

@section scripts{
    <script >
        $("#userGroupName").keyup(function () {
               $("#btnSubmitUG").prop('disabled', true)
            if ($("#userGroupName").val() != "") {
                $("#btnSubmitUG").prop('disabled', false);
                $("#btnSubmitUG").removeClass("disabled");
            }
            else {
                $("#btnSubmitUG").prop('disabled', true);
                $("#btnSubmitUG").addClass("disabled");
            }
        });

        $("#btnSubmitUG").click(function () {
            let Roles=[];
            var UG = new Object();
            let  CC = [];
            UG.Name = $('#userGroupName').val();
            $.each($("input[name='Role']:checked"), function () {
                Roles.push($(this).val());
            });
            for (let i = 0;i<Roles.length ;i++){
                let c = {
                          "Key": i,
                           "Name": Roles[i],
                }
                CC.push(c);
               
            }
            UG.Claims = CC;
            console.log(UG);
            $.ajax({
                type: "POST",
                url: "/UserGroups/Create",
                data: UG,
  

                success: function (response) {
                  window.location.href = response.redirectToUrl;
                },
                error: function (response) {
                    console(response.responseText);
                }
            });
       

          

        });

    </script>
}
